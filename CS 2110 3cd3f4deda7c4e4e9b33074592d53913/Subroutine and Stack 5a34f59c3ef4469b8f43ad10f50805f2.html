<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Subroutine and Stack</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="5a34f59c-3ef4-469b-8f43-ad10f50805f2" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">🚇</span></div><h1 class="page-title">Subroutine and Stack</h1><table class="properties"><tbody><tr class="property-row property-row-select"><th><span class="icon property-icon"><svg viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesSelect"><path d="M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.6738 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM7.62402 10.6348C7.79492 10.915 8.20508 10.9287 8.37598 10.6348L10.666 6.73145C10.8574 6.41016 10.7002 6.04102 10.3652 6.04102H5.62793C5.29297 6.04102 5.14941 6.43066 5.32031 6.73145L7.62402 10.6348Z"></path></svg></span>Type</th><td><span class="selected-value select-value-color-orange">Quiz 3 Material</span></td></tr></tbody></table></header><div class="page-body"><p id="5f6b85c0-32c4-4cdc-83ac-8c741403626a" class="">
</p><p id="4d014f2c-af46-4cd4-9eac-de69356a8efe" class="">Subroutine is another name for function</p><p id="3f4d96e9-ecf9-4f3c-ae74-4b1b151cd278" class="">There is no “function” abstraction in LC-3 assembly. Need to create our own abstraction</p><p id="e7982da6-e6c5-4174-a3fa-f2305ac842a0" class="">
</p><figure id="a5115851-daa2-4e1d-9143-dc721a3717ce" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_16.56.14.png"><img style="width:910px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_16.56.14.png"/></a></figure><h2 id="aa086e12-6afd-4c20-80db-38e4a0b18ee9" class="block-color-pink_background">JSR(Jump to Subroutine)</h2><p id="85d62bcd-c971-4de5-ab19-b6affe8d4af0" class="">The <strong>JSR </strong>instruction computes the target address of the subroutine by sign-extending the 11-bit offset (bits [10:0]) of the instruction to 16 bits and adding that to the incremented PC.</p><figure id="94a0b970-0606-4e63-bb83-bb3207090130" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-12-13_at_03.28.55.png"><img style="width:946px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-12-13_at_03.28.55.png"/></a></figure><p id="ca1b1350-8335-4937-aa5a-d038d110b2c4" class="block-color-red">
<strong>Saves the PC value into R7 and then sets PC to the target1.</strong></p><p id="b09161eb-0608-4b22-97d8-ce8749f405d2" class="">
</p><p id="9161b788-aca2-4332-8578-453ca54c09a8" class="">R7 = PC*(incremented)</p><p id="7bd27039-89cb-42b3-8038-15504d416fb1" class=""><em>PC = PC*</em> + PCOffset11</p><p id="6d7390ce-a6c2-4cec-a368-683e3d00ae67" class="">PC-offset addressing (usually called with a label)</p><p id="9ddba4d7-8f83-4f25-a36c-01078f65c7dd" class="">Note the order is important; we need to save the PC before changing it</p><h2 id="47e7c54c-27b4-4c0a-9e9d-bfd80f543dee" class="block-color-pink_background">JSRR(Jump to Subroutine, Register)</h2><p id="2768dcb3-424d-43c7-be32-cd72698aa7f1" class="">Same as JSR, but u<strong>ses a register for the subroutine&#x27;s address</strong> instead of a label/offset</p><p id="34277a32-3424-492f-b4ce-d5cad64f51a7" class="">R7 = PC*</p><p id="a0d33819-4e0b-4b3a-8843-78384a08c9fc" class="">PC = SR</p><h2 id="2d0fad57-1ea8-410d-8233-b358939c2d41" class="block-color-pink_background">RET(Return)</h2><p id="4e48c0bf-2e69-499b-a357-e2678f277b3e" class="">A special case of JMP. Equivalent to JMP R7</p><p id="b3d009f8-e5a2-4480-9a84-5a6a73f33421" class="">PC = R7</p><p id="da23788c-db6d-4d59-826c-20897419dff7" class="">This is actually a “pseudo-instruction” since it assembles to the exact same bits as JMP R7</p><p id="409993e8-9e6a-49cb-993d-1f4984edb0ef" class="">
</p><h1 id="9458adb2-1380-42cb-bea9-0995b4d51180" class="block-color-purple_background">The Stack</h1><ul id="1ff775b0-45ab-4658-8663-fa0ac063c1ca" class="bulleted-list"><li style="list-style-type:disc">The stack is a location in memory that is useful for storing temporary program data<ul id="a14e9815-741f-4afd-a725-5500b5ad2314" class="bulleted-list"><li style="list-style-type:circle">Subroutine calls –parameters, return values</li></ul><ul id="ecbbd401-c3d4-484b-b8d9-7e9b8185fa11" class="bulleted-list"><li style="list-style-type:circle">Local variables –what if our 8 registers aren’t enough</li></ul></li></ul><p id="59a03e5a-9300-4c5c-a04b-4f7e4522c88f" class="">Grows “downwards” towards smaller memory addresses from a fixed starting location</p><p id="cb2d1ea2-200a-4fcb-a89e-61aff8351792" class="block-color-red"><strong>LAST IN FIRST OUT</strong></p><figure id="d89463b8-6530-4b83-8ca2-443fdc48e0af" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.01.20.png"><img style="width:1802px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.01.20.png"/></a></figure><figure id="78baf29c-27f6-4f3d-8f08-4ff2a7b7ca05" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.01.55.png"><img style="width:1962px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.01.55.png"/></a></figure><figure id="bbd20442-2bde-4483-8c00-acd99cd99f53" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.02.37.png"><img style="width:1928px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.02.37.png"/></a></figure><figure id="a287c1e3-ce48-43f9-b530-941f8fb81297" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Untitled.png"><img style="width:978px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Untitled.png"/></a></figure><p id="6e92daf6-0bae-431f-905c-e3010d98321e" class="">How to call a subroutine</p><ul id="04834593-0ac5-4dc8-8c93-b9982009282d" class="bulleted-list"><li style="list-style-type:disc">Push Argument in reverse order</li></ul><ul id="95511f6e-1c2c-47c8-a4db-7458c214f41f" class="bulleted-list"><li style="list-style-type:disc">JSR</li></ul><p id="267ceee8-fcbb-4018-b477-18e8ddc91751" class="">After subroutine returns</p><ul id="dc1c34ec-91fa-4a2a-8227-ef72b9eb67a9" class="bulleted-list"><li style="list-style-type:disc">Pop return value(on the stack)</li></ul><ul id="f2bb1f48-4774-4ceb-b16a-e048ee6e78da" class="bulleted-list"><li style="list-style-type:disc">Pop the arguments<p id="66cd6b98-3681-41ef-ba33-0309f4d75152" class="">If don&#x27;t pop, the stack overflow</p><figure id="0812848e-5a34-45ea-a34d-f4aebee83c60" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.27.39.png"><img style="width:1840px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.27.39.png"/></a></figure></li></ul><ul id="77a91e82-f307-4272-a796-4ccac89ab32b" class="toggle"><li><details open=""><summary>Example - Calling a subroutine</summary><figure id="9b7437fe-7ffa-4cf1-8c61-33ed4d7aefa7" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.31.54.png"><img style="width:1674px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.31.54.png"/></a></figure><p id="6af5be22-bcb9-4e66-ae1b-3a84bb46fb22" class="">
</p></details></li></ul><ul id="9c6201ae-8a2f-40c9-84ac-453ba024fe0a" class="toggle"><li><details open=""><summary>Symmetry of Caller</summary><figure id="fc65f53b-b446-4bb6-a3a7-65d51504f4fd" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.32.22.png"><img style="width:2130px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.32.22.png"/></a></figure><p id="0b42ca74-6fea-4d98-8001-efbbe0aca174" class="">
</p></details></li></ul><h1 id="82190213-2d0e-48c6-a3f5-e05883bdbccf" class="block-color-purple_background">Frame Pointer</h1><figure id="f0faf718-a2d0-4913-84b5-350cea787c33" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.03.40.png"><img style="width:1788px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.03.40.png"/></a></figure><figure id="c40daee7-4aa8-45d6-84e1-9410809ecf74" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.22.32.png"><img style="width:1442px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.22.32.png"/></a></figure><p id="d7109cac-8d3a-4ae4-b30e-34dd4d833d95" class="">
</p><h1 id="dca2cc79-67c4-4af4-b533-ff8185cb1f57" class="block-color-purple_background">Calling Conventions</h1><p id="ab9a7fc6-68bf-4e31-b023-ab78782cfac3" class="block-color-red">A caller is a function that calls another function; a callee is a function that was called. The currently-executing function is a callee, but not a caller.</p><p id="83f68bba-c521-4f8a-b235-91b3bef64266" class="">Good read on caller/calleee: <a href="https://cs61.seas.harvard.edu/site/2018/Asm2/">https://cs61.seas.harvard.edu/site/2018/Asm2/</a></p><figure id="af496959-8e9a-4efe-8b60-52b75f94df35" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.04.22.png"><img style="width:1448px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.04.22.png"/></a></figure><figure id="44cd2fea-69f1-49ee-afbf-440f3de342d1" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.37.05.png"><img style="width:1602px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.37.05.png"/></a></figure><figure id="20f60a8b-ec5d-4b82-bf16-c9ed185443e6" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.40.35.png"><img style="width:2284px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.40.35.png"/></a></figure><p id="b055e007-1f4e-4f56-99d9-3c4a067df178" class="">If you only have one variable, subroutine will always be the same</p><p id="28741bfb-0c2b-4443-9873-2388f990b4bd" class="">If there are two or more, need to allocate more space</p><h1 id="7bf64966-2c64-4a2d-87fd-d98a4b69c928" class="block-color-purple_background">Building up the stack</h1><figure id="28786112-449b-4265-b911-21e7c3773393" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.04.50.png"><img style="width:1912px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.04.50.png"/></a></figure><p id="49ce624a-e9f5-4774-a4d2-f57095230b8e" class="">
</p><figure id="5463a155-a18c-4ee9-9fd2-2f651e4de8eb" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.33.36.png"><img style="width:1580px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.33.36.png"/></a></figure><figure id="d69d9d6d-7039-402f-aa58-e304630bcc7c" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.34.08.png"><img style="width:1700px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.34.08.png"/></a></figure><p id="d5f619f4-8347-4d61-94c5-8f4b67c8db39" class="">
</p><h1 id="0088e617-50f3-4627-9b66-cc8770e26a92" class="block-color-purple_background">Subroutine calling a subroutine</h1><figure id="f391f7ce-2dfa-4d3e-b180-410b59e5890e" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.05.16.png"><img style="width:1948px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.05.16.png"/></a></figure><figure id="957c4df9-fa16-4da6-bc6a-ad37f97f34e2" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.06.37.png"><img style="width:1822px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.06.37.png"/></a></figure><p id="b91a422a-66b0-44c5-a60c-c5a4a93827c5" class="">
</p><h1 id="acef1a6b-55dd-472a-9480-b71dc8433439" class="block-color-purple_background">Questions</h1><ul id="2f661839-3a90-46a9-bc16-0afec6586499" class="bulleted-list"><li style="list-style-type:disc">What is the stack? What is it used for?</li></ul><ul id="e6534d2e-ea74-41ec-b1ce-bb0ebf5c976c" class="bulleted-list"><li style="list-style-type:disc">What do the values in R5, R6, and R7 represent in the LC-3?</li></ul><p id="30b96ff0-6815-479f-962f-d97163a0e5a4" class="">R5 - frame pointer</p><p id="2d8d760a-2e6b-4bec-91d8-e7f979a77c37" class="">R6 - stack pointer</p><p id="2ccb15bf-ce5c-40aa-8b83-76da4b991df1" class="">R7 - return address</p><ul id="ca80cb3a-6243-43a0-9160-e4b38e27dba3" class="bulleted-list"><li style="list-style-type:disc">What is a &quot;frame pointer&quot;? Why do we need it?</li></ul><p id="59753455-41c2-4106-b665-0c3eaf661fe9" class="">Points to the first local variable on the stack. Exists to directly reference everything under it (stack frame up to that point is constant and never different. Everything after the frame pointer is dynamic and cant literally point to anything consistently.</p><ul id="f0d9ac6a-ea41-47a6-b68b-46ad49c9b202" class="bulleted-list"><li style="list-style-type:disc">How do you push a value onto the stack?</li></ul><figure id="ebd03cbf-3348-4ce5-997a-e3880a4404f0" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Untitled%201.png"><img style="width:885px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Untitled%201.png"/></a></figure><p id="2e1dac4e-2ceb-4adf-afc5-5e9698b2cfe3" class="">DO NOT HAVE TO INITIALIZE R6 </p><ul id="3e3fb198-5601-4e92-8b50-b06e9c3c48aa" class="bulleted-list"><li style="list-style-type:disc">How do you pop a value off of the stack?</li></ul><figure id="f6e47697-6d21-4527-9c7f-55439d69468b" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Untitled%202.png"><img style="width:514px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Untitled%202.png"/></a></figure><ul id="d2b1f184-36b5-4efa-bb37-e33a134a2382" class="bulleted-list"><li style="list-style-type:disc">What if stack is already full/empty?<ul id="9cd565fa-f6c0-4550-859e-ed4d30b49883" class="bulleted-list"><li style="list-style-type:circle">Before pushing, test overflow</li></ul><ul id="d1626320-3b17-4ea2-af23-6c15a43b407e" class="bulleted-list"><li style="list-style-type:circle">Before popping, text underflow</li></ul></li></ul><ul id="25a01828-6557-42b4-9ddb-8e42aff99fba" class="bulleted-list"><li style="list-style-type:disc">Stack points to heap —&gt; Stack Overflow</li></ul><p id="23d5ecef-0441-40ba-916b-2fd45f569c84" class="">
</p><figure id="48006b0e-6369-4418-b9af-8e8743d32950" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Untitled%203.png"><img style="width:973px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Untitled%203.png"/></a></figure><figure id="1522ff48-560e-47ce-bfe9-419ba835a1e3" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.45.02.png"><img style="width:1662px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.45.02.png"/></a></figure><p id="a00d874a-4e71-4402-8bd2-316cbd23eef9" class="">
</p><figure id="0f596d44-fdff-4570-b13e-d8c01f3ed1d0" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.45.13.png"><img style="width:1664px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.45.13.png"/></a></figure><p id="ba87fc3d-9a7f-4eb8-a175-e22e5b3a3ee4" class="">
</p><figure id="0cf6146e-d454-46ba-8f85-47b8032cccae" class="image"><a href="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.45.29.png"><img style="width:1624px" src="Subroutine%20and%20Stack%205a34f59c3ef4469b8f43ad10f50805f2/Screen_Shot_2021-10-18_at_17.45.29.png"/></a></figure><p id="5a1fb8ab-5257-487e-a58e-0c55019e70e9" class="">
</p><pre id="8b0ab3b6-d96c-4729-bf03-243c5134bff8" class="code"><code>;subroutine template(2 args)

subroutine
	ADD R6, R6, -4
	STR R7, R6, 2
	STR R5, R6, 1
	ADD R5, R6, 0
	
	ADD R6, R6, -5
	STR R0, R5, -1
	STR R1, R5, -2
	STR R2, R5, -3
	STR R3, R5, -4
	STR R4, R5, -5


	;perform subroutine operation here

	;recursive call to subroutine.
	ADD R6, R6, -1 ; Push 1 on the stack
	STR RX, R6, 0 ; RX is the first arg to push
	ADD R6, R6, -1 ;Push 1 on the stack
	STR RX, R6, 0 ;RX is the second arg to push
	JSR subroutine ;Call subroutine
	LDR RX, R6, 0 ;Store return value to RX
	ADD R6, R6, 3 ;Pop the two pushed and the return value 
	STR RX, R5, 0 ;Store return value to local variable in current stack

	TEARDOWN
	  LDR R0, R5, 0     ;R0 = Local variable that holds the return value
	  STR R0, R5, 3     ;Retval = R0
	  LDR R4, R5, -5    ; Restore R4
	  LDR R3, R5, -4    ; Restore R3
	  LDR R2, R5, -3    ; Restore R2
	  LDR R1, R5, -2    ; Restore R0
	  LDR R0, R5, -1    ; Restore R1
	  ADD R6, R5, 0     ; Restore SP
	  LDR R5, R6, 1     ; Restore FP
	  LDR R7, R6, 2     ; Restore RA
	  ADD R6, R6, 3     ; Pop ra,fp,lv1

RET</code></pre><p id="5edcb936-95da-47b4-890f-ad0f86e47230" class="">
</p></div></article></body></html>